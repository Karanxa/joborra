# Replace example.com with your domain
joborra.com {
  encode gzip

  # Proxy API (only /api*, let React handle /auth as a client route)
  @api path /api*
  reverse_proxy @api api:8000

  # Everything else goes to the frontend
  reverse_proxy frontend:80
}

# Optional: redirect www to apex
www.joborra.com {
  redir https://joborra.com{uri} permanent
}

# Fallback HTTP site for IP-based or non-DNS deployments
# This does not provision TLS. Useful when accessing via server IP.
:80 {
  encode gzip

  @api path /api*
  reverse_proxy @api api:8000

  reverse_proxy frontend:80
}
